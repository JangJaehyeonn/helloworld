# 리눅스 명령어

## ps명령어

ps명령어는 현재 실행중인 프로세스 목록과 상태를 보여준다.

ps사용법 :`$ ps [option]`

ps 옵션
|옵션|내용|
|------|---|
|-A|모든 프로세스를 출력한다|
|a(BSD계열)|터미널과 연관된 프로세스를 출력하는 옵션이다. 보통 x옵션과 연계하여 모든 프로세스를 출력할 때 사용한다|
|-a|세션 리더(일반적으로 로그인 셀)을 제외하고 데몬 프로세스처럼 터미널에 종속되지 않은 모든 프로세스를 출력한다|
|-e|커널 프로세스를 제외한 모든 프로세스를 출력해 준다|
|-f|풀 포맷으로 보여준다, 유닉스 스타일로 출력해주는 옵션으로 UID, PID, PPID등이 함께 표시된다|
|I(BSD계열)|프로세스의 정보를 길게 보여주는 옵션으로 우선순위와 관련된 PRI와 NI값을 확인할 수 있다|
|-o값|출력 포맷을 지정하는 옵션으로 값으로는 pid, tty, time, cmd 등을 지정할 수 있다|
|-M| 64비트 프로세스들을 보여준다|
|-m|프로세스들 뿐만 아니라 커널 스레드들도 보여준다|
|-p|특정 PID를 지정할 때 사용한다|
|-r|현재 실행 중인 프로세서를 보여준다|
|u(BSD계열)|프로세스의 소유자를 기준으로 출력한다|
|-u|특정 사용자의 프로세스 정보를 확인할 때 사용한다. 사용자를 지정하지 않으면 현재 사용자를 기준으로 정보를 출력한다|
|x(BSD계열)|데몬 프로세스처럼 터미널에 종속되지 않는 프로세스를 출력한다. 보통 a옵션과 결합하여 모든 프로세스를 출력할 때 사용한다|
|-x|로그인 상태에 있는 동안 아직 완료되지 않은 프로세서들을 보여준다

**ps 항목**
|항목|의미|
|------|---|
|USER|BSD계열에서 나타는 항목으로 프로세스 소유자의 이름|
|UID|SYSTEM V계열에서 나타나는 항목으로 프로세스 소유자의 이름|
|PID|프로세스의 식별번호|
|PPID|부모 프로세스 ID|
|%CPU|CPU 사용 비율의 추정치(BSD)|
|%MEM|메모리의 사용 비율의 추정치(BSD)|
|VSZ|K단위 또는 페이지 단위의 가상메모리 사용량|
|RSS|실제 메모리 사용량(Resident Set Size)|
|TTY|프로세스와 연결된 터미널|
|S, STAT|현재 프로세스의 상태 코드(S: Sys V, STAT: BSD)|
|TIME|총 CPU사용 시간|
|COMMAND|프로세스의 실행 명령행|
|STIME|프로세스가 시작된 시간 혹은 날짜|
|C,CP|짧은 기간 동안의 CPU사용률(C:Sys V, CP: BSD)|
|F|프로세스의 플래그|
|PRI|실제 실행 우선순위|
|NI|nice 우선순위 번호|

## top 명령어

top
* 시스템의 상태를 전반적으로 가장 빠르게 파악 가능(CPU, Memory, Process)
* 옵션 없이 입력하면 interval 간격(기본 3초)으로 화면을 갱신하며 정보를 보여줌
* top 실행 전 옵션
1) 순간의 정보를 확인하려면 -b 옵션 추가 (batch 모드)
2) -n : top 실행 주기 설정(반복 횟수)

**top 실행 후 명령어**
* shift + p : CPU 사용률 내림차순
* shift + m :메모리 사용률 내림차순
* k: kill. k 입력후 PID 번호 작성. signal은 9
* f: sort field 선택 화면 -> q누르면 RES 순으로 정렬
* a: 메모리 사용량에 따라 정렬
* b : Batch 모드로 작동
* 1 : CPUT Core별로 사용량 보여줌

**ps와 top의 차이점**
* ps는 ps한 시점에 proc에서 검색한 cpu 사용량
* top은 porc에서 일정 주기로 합산해 cpu 사용율 출력
* <img src="https://user-images.githubusercontent.com/96277705/172039747-507fea2e-9b37-4063-b52c-43e9166d5ea3.PNG" width="50%" height="50%" />

**PR & NI**
* PR : 커널에 의해서 스케줄링되는 우선순위
* NI : PR에 영향을 주는 nice라는 값

* VIRT, RES, SHR, %MEM

해당 필드들은 프로세스의 메모리와 관련이 있다

* VIRT: 프로세스가 소비하고 있는 총 메모리. 프로그램이 실행중인 코드, heap, stack과 같은 메모리, IO buffer 메모리를 포함
* RES: RAM에서 사용중인 메모리의 크기를 나타낸다
* SHR: 다른 프로세스와의 공유메모리를 나타낸다
* %MEM: RAM에서 RES가 차지하는 비율을 나타낸다

S: 프로세스의 현재 상태를 나타낸다
TIME+ : 프로세스가 사용한 토탈 CPU시간
COMMAND: 해당 프로세스를 실행한 커맨드를 나타낸다

## jobs 명령어
* 작업의 상태를 표시하는 명령어
* jobs [옵션][작업번호]

jobs로 출력되는 백그라운드 작업의 상태값
|상태|설명|
|------|---|
|Running|작업이 계속 진행중임|
|Done|작업이 완료되어 0을 반환|
|Done(code)|작업이 종료되었으면 0이 아닌 코드를 반환|
|Stopped|작업이 일시 중단|
|Stopped(SIGTSTP)|SIGTSTP 시그널이 작업을 일시 중단|
|Stopped(SIGSTOP)|SIGSTOP 시그널이 작업을 일시 중단|
|Stopped(SIGTTIN)|SIGTTIN 시그널이 작업을 일시 중단|
|Stopped(SIGTTOU)|SIGTTOU 시그널이 작업을 일시 중단|

**옵션**
|옵션|설명|
|---|---|
|-l|프로세스 그룹 ID를 state 필드 앞에 출력|
|-n|프로세스 그룹 중에 대표 프로세스 ID를 출력|
|-p|각 프로세스 ID에 대해 한 행씩 출력|
|command|지정한 명령어를 실행|

## kill 명령어
* 프로세스를 죽일 때 사용
* 하지만 내부적으로는 프로세스에 시그널을 보내 원하는 작업을 하게 하는 명령어
* `$ kill [options] <pid>[...]`

**프로세스 죽이는 방법**
* 죽이려는 프로세스의 pid를 얻은 다음 kill 명령어의 인자로 넘긴다
* `$ kill [pid]`
* ex) node.js로 실행 중인 서버를 죽이고 싶다면 ps 명령어를 통해 node.js의 pid를 얻고 kill 명령어의 파라미터로 넘겨 실행시키면 종료시킬수 있다
  
**사용자 지정 시그널 전송 방법**
* kill 명령어의 default 시그널은 TERM(15)이다. 하지만 -s명령으로 다른 시그널을 보낼 수 있다
* `$ kill -s[signal][pid]`
* 예를 들어 프로세스가 TERM(15) 시그널에 응답하지 않으면 다음의 명령어 처럼 KILL(9)를 사용해 강제로 죽일 수 있다
* `$ kill -s KILL [pid]`
  
**사용 가능한 시그널의 목록**

-l (List의 l) 명령어를 통해 지원하는 시그널의 목록을 확인할 수 있다

<img src="https://user-images.githubusercontent.com/96277705/172041460-a284f1af-e67b-40cd-a149-8a8fa152760b.PNG" width="50%" height="50%" />
  
**시그널을 보내는 다른 방법**
* `$ kill -s KILL [pid]`
* `$ kill -s SIGKILL [pid]`

  
# vim 에디터에서 매크로 활용 방법

* q + 알파벳을 눌러 특정 알파벳에 매크로를 저장할 수 있다

순서는
1) q + a : a키에 recording 시작
2) 반복을 위한 내가 원하는 동작
3) q : recording 종료
4) @a : 1회 실행  or @@ : 방금 실행한 매크로 실행 or 10@a : 매크로 10회 실행

* 자주 사용하는 매크로 등록 방법
1) ~/.vimrc 를 연다
2) let @a = '매크로 문자열'  이런식으로 매크로로 동작시킬 문자열을 입력한다
  
* 매크로 문자열을 편집기에 그대로 출력하는 방법
1) 편집 모드에서 ctrl +r, ctrl +r, 매크로 문자를 순서대로 입력하면 그대로 출력된다
2) 커맨드 모드에서 "매크로문자p를 입력하여 래지스터로부터 바로 붙여넣기 한다. (ex: "ap, "bp, "cp, "dp, ...)
